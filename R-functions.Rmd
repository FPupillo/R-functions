---
title: "R-functions"
author: "Francesco Pupillo"
date: "02/10/2020"
output: 
  #github_document:
  md_document:
    variant: markdown_github
    toc: true
    toc_depth: 6
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# R functions

This is a collection of functions typically used in R, especially in psychology.  

For any question, feel free to drop me an email : pupillo@psych.uni-frankfurt.de

### Exclude rows based on a set of criteria (or participants)
Useful code to exclude rows in a dataset that corresponds to participants we decided to exclude. 

```{r exclusionSeveralCriteria, echo=TRUE}

# create fake dataframe with participants and performance columns
df<-data.frame(participants=seq(1:10), performance= sample(seq(0, 1, length.out = 100), 10, T))

df
# Participants that we want to exclude
partExcl<-c(1,3,5)

# code to exclude participants
df<-df[!df$participants %in% partExcl, ]

df

```
### Count the arguments of a function
Function that returns the number of arguments in a function
```{r count the arguments of a function, echo=TRUE}
# let's create a function that calculate the means between three dimenions (x, y ,z)

foo<-function(x, y, z){
  sum (x, y, z)/ length(c(x, y,z))
}

# now I want to assign the number of the arguments of this function to a vector. 
# I can use "formals" to store the argumens

fooArgs<-formals(foo)

fooArgs

# then I can extract the number of the arguments with "length"
numfooArgs<-length(fooArgs)

numfooArgs
```
  
### Call a function by a character string
How to assign a name of a function to a character string and then call it later? By using "get".
```{r call a function by a character string, echo=TRUE}
# Create a function. This one calculate the average of three dimensions

foo<-function(x, y, z){
  sum (x, y, z)/ length(c(x, y,z))
}

# Now create a carachter string with the name of the formula

foostr<-"foo"

foostr

# use "get" to call the function

myfunction<-get(foostr)

# now we can call our function
myfunction(3,4,5)

numfooArgs
```

### Select files that meet a criterion
Selecting files that meets a criterion, or file estention
```{r select files, echo=TRUE}
# create a vector with names that vary in different ways
files<-vector()

for (i in 1:10){
  # the first five are .csv, the others are .pdf
  if (i<6){
  files[i]<- paste("myfile", i, ".csv", sep="")
  } else{
  files[i]<- paste("myfile", i, ".pdf", sep="")
}
}

# plus some random files
files[11:13]<-c("random1.pdf", "test2.csv", "dunno.rnd")

# create the files in a subfolder
# dir.create("testsel")

 setwd("testsel")

# create files
for (f in 1:length(files)){
  write(0, file = files[f])
}



# select all the files that are .csv
selCsv<-list.files( pattern= ".csv$")
selCsv

# now, select files that are .csv OR that start with "myfile"
selCsv<-list.files(pattern= c("myfile", ".csv$"))
selCsv

# now, select files that are .csv AND that start with "myfile"
selCsv<-list.files(pattern= c("myfile.*.csv$"))
selCsv

```